{"version":3,"sources":["../../../../../src/test/Queue/jobs/job.spec.ts"],"sourcesContent":["import CacheImageRequest, {\r\n\tBackgroundOptions,\r\n\tFitOptions,\r\n\tPositionOptions,\r\n\tSupportedResizeFormats,\r\n} from '@microservice/API/dto/cache-image-request.dto'\r\nimport GenerateResourceIdentityFromRequestJob from '@microservice/Queue/jobs/generate-resource-identity-from-request.job'\r\nimport { beforeEach, describe, expect, it } from 'vitest'\n\r\ndescribe('generateResourceIdentityFromRequestJob', () => {\r\n\tlet job: GenerateResourceIdentityFromRequestJob\r\n\r\n\tbeforeEach(() => {\r\n\t\tjob = new GenerateResourceIdentityFromRequestJob()\r\n\t})\r\n\r\n\tit('should be defined', () => {\r\n\t\texpect(job).toBeDefined()\r\n\t})\r\n\r\n\tit('should generate a deterministic resource identifier', async () => {\r\n\t\tconst mockRequest = new CacheImageRequest({\r\n\t\t\tresourceTarget: 'http://localhost/resource',\r\n\t\t\tresizeOptions: {\r\n\t\t\t\twidth: 100,\r\n\t\t\t\theight: 200,\r\n\t\t\t\tfit: FitOptions.contain,\r\n\t\t\t\tposition: PositionOptions.center,\r\n\t\t\t\tformat: SupportedResizeFormats.webp,\r\n\t\t\t\tbackground: BackgroundOptions.transparent,\r\n\t\t\t\ttrimThreshold: 5,\r\n\t\t\t\tquality: 100,\r\n\t\t\t},\r\n\t\t})\r\n\r\n\t\tconst id1 = await job.handle(mockRequest)\r\n\t\tconst id2 = await job.handle(mockRequest)\r\n\t\texpect(id1).toEqual(id2)\r\n\r\n\t\texpect(id1).toMatch(\r\n\t\t\t/^[0-9a-f]{8}-[0-9a-f]{4}-5[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/,\r\n\t\t)\r\n\t})\r\n})\r\n"],"names":["CacheImageRequest","BackgroundOptions","FitOptions","PositionOptions","SupportedResizeFormats","GenerateResourceIdentityFromRequestJob","beforeEach","describe","expect","it","job","toBeDefined","mockRequest","resourceTarget","resizeOptions","width","height","fit","contain","position","center","format","webp","background","transparent","trimThreshold","quality","id1","handle","id2","toEqual","toMatch"],"mappings":"AAAA,OAAOA,qBACNC,iBAAiB,EACjBC,UAAU,EACVC,eAAe,EACfC,sBAAsB,QAChB,0DAA+C;AACtD,OAAOC,4CAA4C,iFAAsE;AACzH,SAASC,UAAU,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,EAAE,QAAQ,SAAQ;AAEzDF,SAAS,0CAA0C;IAClD,IAAIG;IAEJJ,WAAW;QACVI,MAAM,IAAIL;IACX;IAEAI,GAAG,qBAAqB;QACvBD,OAAOE,KAAKC,WAAW;IACxB;IAEAF,GAAG,uDAAuD;QACzD,MAAMG,cAAc,IAAIZ,kBAAkB;YACzCa,gBAAgB;YAChBC,eAAe;gBACdC,OAAO;gBACPC,QAAQ;gBACRC,KAAKf,WAAWgB,OAAO;gBACvBC,UAAUhB,gBAAgBiB,MAAM;gBAChCC,QAAQjB,uBAAuBkB,IAAI;gBACnCC,YAAYtB,kBAAkBuB,WAAW;gBACzCC,eAAe;gBACfC,SAAS;YACV;QACD;QAEA,MAAMC,MAAM,MAAMjB,IAAIkB,MAAM,CAAChB;QAC7B,MAAMiB,MAAM,MAAMnB,IAAIkB,MAAM,CAAChB;QAC7BJ,OAAOmB,KAAKG,OAAO,CAACD;QAEpBrB,OAAOmB,KAAKI,OAAO,CAClB;IAEF;AACD"}