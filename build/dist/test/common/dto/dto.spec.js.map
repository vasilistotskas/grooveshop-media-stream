{"version":3,"sources":["../../../../../src/test/common/dto/dto.spec.ts"],"sourcesContent":["import CacheImageRequest, { BackgroundOptions, FitOptions, PositionOptions, ResizeOptions, SupportedResizeFormats } from '@microservice/API/dto/cache-image-request.dto'\r\nimport ResourceMetaData, {\r\n\tdefaultPrivateTTL,\r\n\tdefaultPublicTTL,\r\n\tresourceMetaVersion,\r\n} from '@microservice/HTTP/dto/resource-meta-data.dto'\r\nimport ManipulationJobResult from '@microservice/Queue/dto/manipulation-job-result.dto'\r\nimport { describe, expect, it } from 'vitest'\r\n\r\ndescribe('resizeOptions', () => {\r\n\tit('should set default values', () => {\r\n\t\tconst resizeOptions = new ResizeOptions()\r\n\r\n\t\texpect(resizeOptions.width).toBeNull()\r\n\t\texpect(resizeOptions.height).toBeNull()\r\n\t\texpect(resizeOptions.fit).toBe(FitOptions.contain)\r\n\t\texpect(resizeOptions.position).toBe(PositionOptions.entropy)\r\n\t\texpect(resizeOptions.format).toBe(SupportedResizeFormats.webp)\r\n\t\texpect(resizeOptions.background).toBe(BackgroundOptions.white)\r\n\t\texpect(resizeOptions.trimThreshold).toBeNull()\r\n\t\texpect(resizeOptions.quality).toBe(80)\r\n\t})\r\n\r\n\tit('should accept custom values', () => {\r\n\t\tconst customOptions = {\r\n\t\t\twidth: 500,\r\n\t\t\theight: 400,\r\n\t\t\tfit: FitOptions.cover,\r\n\t\t\tposition: PositionOptions.center,\r\n\t\t\tformat: SupportedResizeFormats.jpeg,\r\n\t\t\tbackground: '#FF0000',\r\n\t\t\ttrimThreshold: 10,\r\n\t\t\tquality: 80,\r\n\t\t}\r\n\r\n\t\tconst resizeOptions = new ResizeOptions(customOptions)\r\n\r\n\t\texpect(resizeOptions.width).toBe(500)\r\n\t\texpect(resizeOptions.height).toBe(400)\r\n\t\texpect(resizeOptions.fit).toBe(FitOptions.cover)\r\n\t\texpect(resizeOptions.position).toBe(PositionOptions.center)\r\n\t\texpect(resizeOptions.format).toBe(SupportedResizeFormats.jpeg)\r\n\t\texpect(resizeOptions.background).toEqual({ r: 255, g: 0, b: 0, alpha: 1 })\r\n\t\texpect(resizeOptions.trimThreshold).toBe(10)\r\n\t\texpect(resizeOptions.quality).toBe(80)\r\n\t})\r\n\r\n\tit('should handle transparent background correctly', () => {\r\n\t\tconst resizeOptions = new ResizeOptions({ background: 'transparent' })\r\n\r\n\t\texpect(resizeOptions.background).toEqual({ r: 0, g: 0, b: 0, alpha: 0 })\r\n\t})\r\n\r\n\tit('should delete width and height when set to null', () => {\r\n\t\tconst resizeOptions = new ResizeOptions({ width: null, height: null })\r\n\r\n\t\texpect(resizeOptions.width).toBeUndefined()\r\n\t\texpect(resizeOptions.height).toBeUndefined()\r\n\t})\r\n\r\n\tit('should handle default values for quality and trimThreshold', () => {\r\n\t\tconst resizeOptions = new ResizeOptions({ quality: undefined, trimThreshold: null })\r\n\r\n\t\texpect(resizeOptions.quality).toBe(80)\r\n\t\texpect(resizeOptions.trimThreshold).toBeNull()\r\n\t})\r\n})\r\n\r\ndescribe('cacheImageRequest', () => {\r\n\tit('should set default values for CacheImageRequest', () => {\r\n\t\tconst cacheImageRequest = new CacheImageRequest()\r\n\r\n\t\texpect(cacheImageRequest.resourceTarget).toBe('')\r\n\t\texpect(cacheImageRequest.ttl).toBeUndefined()\r\n\t\texpect(cacheImageRequest.resizeOptions).toBeDefined()\r\n\t})\r\n\r\n\tit('should accept custom values', () => {\r\n\t\tconst resizeOptions = new ResizeOptions({ width: 100, height: 200 })\r\n\t\tconst customRequest = {\r\n\t\t\tresourceTarget: 'http://example.com/image.jpg',\r\n\t\t\tttl: 3600,\r\n\t\t\tresizeOptions,\r\n\t\t}\r\n\r\n\t\tconst cacheImageRequest = new CacheImageRequest(customRequest)\r\n\r\n\t\texpect(cacheImageRequest.resourceTarget).toBe('http://example.com/image.jpg')\r\n\t\texpect(cacheImageRequest.ttl).toBe(3600)\r\n\t\texpect(cacheImageRequest.resizeOptions).toBe(resizeOptions)\r\n\t})\r\n\r\n\tit('should handle partial input', () => {\r\n\t\tconst customRequest = {\r\n\t\t\tresourceTarget: 'http://example.com/image.jpg',\r\n\t\t}\r\n\r\n\t\tconst cacheImageRequest = new CacheImageRequest(customRequest)\r\n\r\n\t\texpect(cacheImageRequest.resourceTarget).toBe('http://example.com/image.jpg')\r\n\t\texpect(cacheImageRequest.ttl).toBeUndefined()\r\n\t\texpect(cacheImageRequest.resizeOptions).toBeDefined()\r\n\t})\r\n})\r\n\r\ndescribe('manipulationJobResult', () => {\r\n\tit('should create an instance with default values', () => {\r\n\t\tconst result = new ManipulationJobResult()\r\n\t\texpect(result.size).toBe('')\r\n\t\texpect(result.format).toBe('')\r\n\t})\r\n\r\n\tit('should create an instance with provided data', () => {\r\n\t\tconst data = { size: '1024', format: 'webp' }\r\n\t\tconst result = new ManipulationJobResult(data)\r\n\t\texpect(result.size).toBe('1024')\r\n\t\texpect(result.format).toBe('webp')\r\n\t})\r\n\r\n\tit('should handle partial input', () => {\r\n\t\tconst data = { size: '2048' }\r\n\t\tconst result = new ManipulationJobResult(data)\r\n\t\texpect(result.size).toBe('2048')\r\n\t\texpect(result.format).toBe('')\r\n\t})\r\n})\r\n\r\ndescribe('resourceMetaData', () => {\r\n\tit('should create an instance with default values', () => {\r\n\t\tconst metaData = new ResourceMetaData()\r\n\r\n\t\texpect(metaData.version).toBe(resourceMetaVersion)\r\n\t\texpect(metaData.publicTTL).toBe(defaultPublicTTL)\r\n\t\texpect(metaData.privateTTL).toBe(defaultPrivateTTL)\r\n\t\texpect(metaData.size).toBe('')\r\n\t\texpect(metaData.format).toBe('')\r\n\t\texpect(metaData.dateCreated).toBeDefined()\r\n\t})\r\n\r\n\tit('should create an instance with provided data', () => {\r\n\t\tconst data = {\r\n\t\t\tversion: 2,\r\n\t\t\tsize: '2048',\r\n\t\t\tformat: 'png',\r\n\t\t\tdateCreated: Date.now(),\r\n\t\t\tprivateTTL: 1000,\r\n\t\t\tpublicTTL: 2000,\r\n\t\t}\r\n\r\n\t\tconst metaData = new ResourceMetaData(data)\r\n\r\n\t\texpect(metaData.version).toBe(2)\r\n\t\texpect(metaData.size).toBe('2048')\r\n\t\texpect(metaData.format).toBe('png')\r\n\t\texpect(metaData.dateCreated).toBe(data.dateCreated)\r\n\t\texpect(metaData.privateTTL).toBe(1000)\r\n\t\texpect(metaData.publicTTL).toBe(2000)\r\n\t})\r\n\r\n\tit('should handle partial input and fallback to default values', () => {\r\n\t\tconst data = { size: '4096', format: 'jpeg' }\r\n\t\tconst metaData = new ResourceMetaData(data)\r\n\r\n\t\texpect(metaData.size).toBe('4096')\r\n\t\texpect(metaData.format).toBe('jpeg')\r\n\t\texpect(metaData.version).toBe(resourceMetaVersion)\r\n\t\texpect(metaData.publicTTL).toBe(defaultPublicTTL)\r\n\t\texpect(metaData.privateTTL).toBe(defaultPrivateTTL)\r\n\t\texpect(metaData.dateCreated).toBeDefined()\r\n\t})\r\n})\r\n"],"names":["CacheImageRequest","BackgroundOptions","FitOptions","PositionOptions","ResizeOptions","SupportedResizeFormats","ResourceMetaData","defaultPrivateTTL","defaultPublicTTL","resourceMetaVersion","ManipulationJobResult","describe","expect","it","resizeOptions","width","toBeNull","height","fit","toBe","contain","position","entropy","format","webp","background","white","trimThreshold","quality","customOptions","cover","center","jpeg","toEqual","r","g","b","alpha","toBeUndefined","undefined","cacheImageRequest","resourceTarget","ttl","toBeDefined","customRequest","result","size","data","metaData","version","publicTTL","privateTTL","dateCreated","Date","now"],"mappings":"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"}