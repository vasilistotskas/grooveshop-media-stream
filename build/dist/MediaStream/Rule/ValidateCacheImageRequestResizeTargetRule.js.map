{"version":3,"sources":["../../../../src/MediaStream/Rule/ValidateCacheImageRequestResizeTargetRule.ts"],"sourcesContent":["import { Injectable, Scope } from '@nestjs/common'\r\nimport CacheImageRequest from '@microservice/API/DTO/CacheImageRequest'\r\nimport RequestedResizeTargetTooLargeException from '@microservice/API/Exception/RequestedResizeTargetTooLargeException'\r\n\r\n@Injectable({ scope: Scope.REQUEST })\r\nexport default class ValidateCacheImageRequestResizeTargetRule {\r\n\t//8K Squared\r\n\tallowedPixelCount = 7680 * 4320\r\n\r\n\trequest: CacheImageRequest = null\r\n\r\n\tpublic async setup(request: CacheImageRequest): Promise<void> {\r\n\t\tthis.request = request\r\n\t}\r\n\r\n\tpublic async apply(): Promise<void> {\r\n\t\tconst pixelCount = this.request.resizeOptions.width + this.request.resizeOptions.height\r\n\t\tif (pixelCount > this.allowedPixelCount) {\r\n\t\t\tthrow new RequestedResizeTargetTooLargeException(this.request.resizeOptions, this.allowedPixelCount)\r\n\t\t}\r\n\t}\r\n}\r\n"],"names":["ValidateCacheImageRequestResizeTargetRule","setup","request","apply","pixelCount","resizeOptions","width","height","allowedPixelCount","RequestedResizeTargetTooLargeException","Injectable","scope","Scope","REQUEST"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;eAKqBA;;;wBALa;+FAEiB;;;;;;;;;;;;AAGpC,IAAA,AAAMA,4CAAN,MAAMA;IAMpB,MAAaC,MAAMC,OAA0B,EAAiB;QAC7D,IAAI,CAACA,OAAO,GAAGA;IAChB;IAEA,MAAaC,QAAuB;QACnC,MAAMC,aAAa,IAAI,CAACF,OAAO,CAACG,aAAa,CAACC,KAAK,GAAG,IAAI,CAACJ,OAAO,CAACG,aAAa,CAACE,MAAM;QACvF,IAAIH,aAAa,IAAI,CAACI,iBAAiB,EAAE;YACxC,MAAM,IAAIC,+CAAsC,CAAC,IAAI,CAACP,OAAO,CAACG,aAAa,EAAE,IAAI,CAACG,iBAAiB;QACpG;IACD;;QAdA,YAAY;aACZA,oBAAoB,OAAO;aAE3BN,UAA6B;;AAY9B;AAhBqBF;IADpBU,IAAAA,kBAAU,EAAC;QAAEC,OAAOC,aAAK,CAACC,OAAO;IAAC;GACdb"}